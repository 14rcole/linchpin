---
# This playbook contains common play that will be ran before the provisioning starts.

#  debug:
#    msg: "{{ item }}"
#  with_items: "{{ aws_res_grps }}"

- name: "Updating topology_outputs"
  set_fact:
    topology_outputs:
      os_server_res: "{{ topology_outputs_os_server }}"
      os_keypair_res: "{{ topology_outputs_os_keypair }}"
      os_volume_res: "{{ topology_outputs_os_volume }}"
      os_obj_res: "{{ topology_outputs_os_object }}"
      os_heat_res: "{{ topology_outputs_os_heat }}"
      aws_ec2_res: "{{ topology_outputs_aws_ec2 }}"
      gcloud_gce_res: "{{ topology_outputs_gce }}"
      duffy_res: "{{ topology_outputs_duffy }}"

- name: "output vars"
  template:
    src: "../templates/output_formatter.j2"
    dest: "{{ topology_output_file | default( outputfolder_path+'/'+output.output.data.topology_name ) }}"
  when: state == "present"
